# 汽車美容預約平台

## 專案簡介
本專案是一個全功能的汽車美容預約平台，連接洗車服務商（B端）與消費者（C端），提供線上預約功能。系統不僅包含基本的BC連接功能，還整合了管理員後台、SEO優化工具以及完整的資訊安全防護機制。

## 已實現功能清單

### 前台用戶端功能
#### 一般用戶功能
1. **用戶認證系統**
   - 安全的註冊流程（含密碼強度檢測）
   - 防暴力破解的登入系統（失敗次數限制+延遲鎖定）
   - JWT認證機制

2. **首頁和導航**
   - 平台首頁展示及功能導航
   - 動態導航選單（根據用戶登入狀態顯示）

3. **商家相關功能**
   - 商家列表與搜尋
   - 商家詳情頁（含服務項目及評價）
   - 附近商家地理定位搜尋

4. **預約管理**
   - 預約服務流程
   - 個人預約記錄查詢
   - 預約狀態更新及取消

5. **社區功能**
   - 愛車社區（貼文查看與互動）
   - 用戶評價系統

6. **用戶個人中心**
   - 個人資料管理
   - 密碼修改（含安全驗證）

#### B端商家功能
1. **商家入駐**
   - 商家註冊及資料提交
   - 營業資訊管理

2. **服務管理**
   - 服務項目設置（價格、時長等）
   - 服務上下架

3. **預約處理**
   - 預約請求接收與處理
   - 訂單狀態管理
   - 預約日曆與管理介面

### 後台管理系統
1. **管理員儀表板**
   - 系統總覽數據統計
   - 快速功能導航

2. **用戶管理**
   - 所有用戶列表與搜尋
   - 用戶角色設置與編輯
   - 用戶篩選功能

3. **預約管理**
   - 全平台預約記錄查詢
   - 多重條件篩選
   - 預約狀態修改

4. **商家管理**
   - 商家審核功能
   - 商家資訊修改

5. **SEO管理工具**
   - 頁面元數據管理（標題、描述、關鍵詞）
   - 結構化數據編輯
   - 網站地圖管理
   - SEO分析報告

## 技術架構

### 前端技術
- **框架**: Vue.js 3 + Composition API
- **路由**: Vue Router
- **HTTP客戶端**: Axios
- **構建工具**: Vite
- **CSS框架**: 自定義樣式（響應式設計）

### 後端技術
- **語言**: JavaScript (Node.js)
- **框架**: Express.js
- **API風格**: RESTful API
- **數據儲存**: 記憶體資料（開發階段）
- **認證**: JWT (JSON Web Tokens)

## 安全機制
本專案特別注重資訊安全，實施了多層次的安全防護措施：

### 後端安全
1. **密碼安全**
   - **bcryptjs密碼加鹽雜湊儲存**：不直接儲存原始密碼，而是使用bcryptjs演算法將密碼轉換成無法反向解密的雜湊值。即使資料庫被入侵，攻擊者也無法獲取用戶原始密碼。
   - **強制密碼複雜度檢查**：要求密碼包含大小寫字母、數字和特殊符號，並設定最小長度要求，防止用戶使用容易被猜測的簡單密碼。

2. **認證與授權**
   - **JWT令牌認證**：使用JSON Web Token進行使用者身份驗證，令牌中包含用戶身份信息及權限，但經過加密簽名，確保資料無法被竄改。
   - **基於角色的權限控制**：根據用戶角色（如普通用戶、商家、管理員）設置不同權限，確保用戶只能訪問其權限範圍內的資源和功能。
   - **令牌過期機制**：JWT令牌設有過期時間，即使令牌被盜用，也只在有限時間內有效，減少安全風險。

3. **API安全**
   - **Helmet標頭保護**：設置各種HTTP標頭，防範常見Web攻擊，包括：
     * Content-Security-Policy：控制頁面可載入的資源來源，防止XSS攻擊。
     * X-XSS-Protection：啟用瀏覽器內建的XSS防護機制。
     * X-Frame-Options：防止網站在iframe中被嵌入，避免點擊劫持攻擊。
     * X-Content-Type-Options：防止瀏覽器進行MIME類型嗅探，減少安全風險。
   - **Express Rate Limit速率限制**：限制單一IP在特定時間內可發送的請求數量，防止暴力破解和DoS攻擊。對登入等敏感操作設置更嚴格的限制。
   - **XSS-Clean輸入淨化**：過濾和清理使用者輸入的資料，移除可能包含的惡意腳本，防止跨站腳本攻擊(XSS)。

4. **錯誤處理**
   - **生產環境安全錯誤處理**：在生產環境中不返回詳細的錯誤堆疊信息，只返回簡單錯誤消息，避免洩露系統結構和實現細節。
   - **適當的錯誤響應格式**：統一的錯誤響應格式，包含狀態碼和描述性消息，但不包含可能被利用的內部系統信息。

### 前端安全
1. **輸入驗證**
   - **客戶端輸入驗證**：在資料送往伺服器前，先在前端進行基本驗證，確保資料格式正確，減少無效請求和潛在安全風險。
   - **密碼強度即時檢查**：當用戶輸入密碼時，即時評估密碼強度並提供視覺反饋和改進建議，引導用戶設置強密碼。

2. **暴力破解防護**
   - **登入失敗次數限制**：記錄登入失敗次數，當失敗次數超過閾值時暫時鎖定帳號。
   - **指數增長的延遲鎖定機制**：隨著失敗登入嘗試次數增加，鎖定時間呈指數增長（例如：5次失敗後鎖定30秒，6次失敗後鎖定60秒，依此類推），有效阻止自動化攻擊工具。
   - **本地狀態持久化**：將登入失敗狀態保存在本地存儲中，即使用戶重新整理頁面或關閉後重開瀏覽器，鎖定狀態仍然有效，防止繞過限制。

3. **用戶輔助功能**
   - **安全提示與建議**：向用戶提供密碼安全、帳號保護等方面的提示和建議，提高用戶安全意識。
   - **密碼強度可視化指示**：直觀的密碼強度指示器，使用色彩和進度條等視覺元素，幫助用戶理解其密碼的安全程度。

### 通用安全措施
1. **環境變數管理**
   - 敏感配置（如JWT密鑰、資料庫憑證等）通過環境變數管理，避免硬編碼在源代碼中，防止機密信息洩露。
   - 使用.env.example提供範本，但不包含實際的敏感信息。

2. **資料傳輸安全**
   - 建議在生產環境中使用HTTPS協議，確保客戶端和伺服器之間的資料傳輸加密，防止中間人攻擊和資料竊聽。

3. **安全監控與日誌**
   - 記錄關鍵操作和異常行為，便於安全審計和問題排查。
   - 敏感操作（如管理員操作、密碼修改等）有特殊的日誌記錄，便於追蹤潛在的安全事件。

## 如何啟動項目

### 環境要求
- Node.js 14+
- npm 6+

### 安裝和運行
```bash
# 克隆專案
git clone <repository-url>
cd 汽車美容預約平台

# 設置環境變數
cp backend/.env.example backend/.env
# 編輯 .env 文件配置JWT_SECRET等敏感資訊

# 後端設置
cd backend
npm install
npm start

# 前端設置（開新終端）
cd frontend
npm install
npm run dev
```

### 開發與生產環境
- **開發環境**: `npm run dev`（前端）/ `npm run dev`（後端）
- **生產環境**: `npm run build`（前端）/ `npm start`（後端）

## 測試帳號
您可以使用以下測試帳號登入系統：

### 用戶角色
- **普通用戶**:
  - 手機號碼：0912345678
  - 密碼：password123

- **管理員**:
  - 手機號碼：0911111111
  - 密碼：admin123

## API端點文檔

### 用戶認證
- `POST /api/auth/login` - 用戶登入
- `POST /api/auth/register` - 用戶註冊

### 用戶資料
- `GET /api/user` - 獲取當前用戶資訊
- `PUT /api/user` - 更新用戶資訊

### 商家相關
- `GET /api/providers` - 獲取商家列表
- `GET /api/providers/{id}` - 獲取商家詳情
- `POST /api/providers` - 商家註冊(B端)
- `PUT /api/providers/{id}` - 更新商家資訊

### 服務相關
- `GET /api/providers/{id}/services` - 獲取商家服務
- `POST /api/providers/{id}/services` - 創建服務

### 預約相關
- `GET /api/appointments` - 獲取預約列表
- `POST /api/appointments` - 創建預約
- `PUT /api/appointments/{id}` - 更新預約狀態
- `DELETE /api/appointments/{id}` - 取消預約

### 評價相關
- `POST /api/providers/{id}/reviews` - 提交評價

### 管理員API
- `GET /api/admin/users` - 獲取所有用戶
- `PUT /api/admin/users/{id}` - 更新用戶資訊
- `GET /api/admin/appointments` - 獲取所有預約
- `GET /api/admin/dashboard` - 獲取儀表板數據

### SEO管理API
- `GET /api/admin/seo/metadata` - 獲取頁面元數據
- `PUT /api/admin/seo/metadata/{path}` - 更新頁面元數據
- `GET /api/admin/seo/schemas` - 獲取結構化數據
- `POST /api/admin/seo/schemas` - 創建結構化數據
- `GET /api/admin/seo/sitemap` - 獲取網站地圖
- `POST /api/admin/seo/generate-sitemap` - 生成網站地圖
- `POST /api/admin/seo/submit-sitemap` - 提交網站地圖

## 專案目錄結構
```
汽車美容預約平台/
├── backend/                # 後端代碼
│   ├── app.js             # 主應用文件
│   ├── package.json       # 後端依賴設定
│   └── .env.example       # 環境變數範例
│
├── frontend/              # 前端代碼
│   ├── components/        # 共用元件
│   ├── pages/             # 頁面元件
│   │   ├── admin/         # 管理員後台頁面
│   │   └── ...            # 其他頁面
│   ├── services/          # API服務
│   ├── router.js          # 路由配置
│   ├── App.vue            # 主應用元件
│   ├── index.html         # HTML入口
│   └── vite.config.js     # Vite配置
│
└── README.md              # 專案文檔
```

## 未來發展計畫
1. **數據庫集成**
   - 遷移至MySQL/PostgreSQL
   - 數據遷移與備份機制

2. **功能擴展**
   - 整合線上支付系統
   - 推送通知系統（短信/電子郵件）
   - 行動應用程式開發

3. **效能與安全優化**
   - 代碼審計與漏洞掃描
   - 前端性能優化
   - CDN整合

4. **商業功能增強**
   - 多級會員系統
   - 營銷活動工具
   - 數據分析與商業智能